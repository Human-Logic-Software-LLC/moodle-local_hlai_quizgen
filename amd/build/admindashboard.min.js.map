{"version":3,"file":"admindashboard.min.js","sources":["../src/admindashboard.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * AI Quiz Generator - Admin Dashboard Module\n *\n * Handles chart rendering for the admin dashboard.\n * Renders usage trend, adoption donut, Bloom's taxonomy radar,\n * question type bar, and difficulty distribution charts using ApexCharts.\n *\n * @module     local_hlai_quizgen/admindashboard\n * @package\n * @copyright  2025 Human Logic Software LLC\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* global ApexCharts */\ndefine(['jquery'], function($) {\n    'use strict';\n\n    /**\n     * Admin Dashboard controller\n     */\n    var AdminDashboard = {\n        charts: {},\n\n        /**\n         * Initialize the admin dashboard charts.\n         * @param {object} data - Chart data passed from PHP via js_call_amd.\n         */\n        init: function(data) {\n            var self = this;\n            this.waitForApexCharts().then(function() {\n                self.renderCharts(data);\n                return undefined;\n            }).catch(function() {\n                // ApexCharts loading failed silently.\n            });\n        },\n\n        /**\n         * Wait for ApexCharts library to be available.\n         * Polls every 100ms for up to 5 seconds.\n         * @returns {Promise}\n         */\n        waitForApexCharts: function() {\n            return new Promise(function(resolve) {\n                if (typeof ApexCharts !== 'undefined') {\n                    resolve();\n                    return;\n                }\n\n                var attempts = 0;\n                var maxAttempts = 50;\n                var checkInterval = setInterval(function() {\n                    attempts++;\n                    if (typeof ApexCharts !== 'undefined') {\n                        clearInterval(checkInterval);\n                        resolve();\n                    } else if (attempts >= maxAttempts) {\n                        clearInterval(checkInterval);\n                        // ApexCharts did not load in time.\n                        resolve();\n                    }\n                }, 100);\n            });\n        },\n\n        /**\n         * Render all five admin dashboard charts.\n         * @param {object} data - Chart data object.\n         */\n        renderCharts: function(data) {\n            this.renderUsageTrend(data);\n            this.renderAdoptionChart(data);\n            this.renderBloomsChart(data);\n            this.renderQuestionTypeChart(data);\n            this.renderDifficultyChart(data);\n        },\n\n        /**\n         * Render the Usage Trend area chart.\n         * @param {object} data - Chart data object.\n         */\n        renderUsageTrend: function(data) {\n            var el = document.querySelector('#usageTrendChart');\n            if (!el || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var usageTrendOptions = {\n                series: [{\n                    name: 'Questions Generated',\n                    data: data.trendCounts\n                }],\n                chart: {\n                    type: 'area',\n                    height: 250,\n                    toolbar: {show: false},\n                    fontFamily: 'inherit'\n                },\n                colors: ['#3B82F6'],\n                dataLabels: {enabled: false},\n                stroke: {\n                    curve: 'smooth',\n                    width: 2\n                },\n                fill: {\n                    type: 'gradient',\n                    gradient: {\n                        shadeIntensity: 1,\n                        opacityFrom: 0.4,\n                        opacityTo: 0.1\n                    }\n                },\n                xaxis: {\n                    categories: data.trendDates,\n                    labels: {show: true}\n                },\n                tooltip: {\n                    x: {format: 'dd MMM yyyy'}\n                }\n            };\n\n            this.charts.usageTrend = new ApexCharts(el, usageTrendOptions);\n            this.charts.usageTrend.render();\n        },\n\n        /**\n         * Render the Adoption donut chart.\n         * @param {object} data - Chart data object.\n         */\n        renderAdoptionChart: function(data) {\n            var el = document.querySelector('#adoptionChart');\n            if (!el || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var adoptionOptions = {\n                series: [data.activeTeachers, data.inactiveTeachers],\n                chart: {\n                    type: 'donut',\n                    height: 250,\n                    fontFamily: 'inherit'\n                },\n                labels: ['Active Teachers', 'Inactive Teachers'],\n                colors: ['#10B981', '#BFDBFE'],\n                legend: {\n                    position: 'bottom',\n                    fontSize: '13px'\n                },\n                dataLabels: {\n                    enabled: true,\n                    style: {\n                        fontSize: '14px',\n                        fontWeight: 600,\n                        colors: ['#1E293B']\n                    },\n                    dropShadow: {\n                        enabled: true,\n                        top: 1,\n                        left: 1,\n                        blur: 2,\n                        color: '#fff',\n                        opacity: 0.8\n                    }\n                },\n                plotOptions: {\n                    pie: {\n                        donut: {\n                            labels: {\n                                show: true,\n                                total: {\n                                    show: true,\n                                    label: 'Total Users',\n                                    fontSize: '14px',\n                                    fontWeight: 600,\n                                    color: '#334155'\n                                },\n                                value: {\n                                    fontSize: '20px',\n                                    fontWeight: 700,\n                                    color: '#1E293B'\n                                }\n                            }\n                        }\n                    }\n                },\n                states: {\n                    hover: {filter: {type: 'lighten', value: 0.05}},\n                    active: {filter: {type: 'none'}}\n                },\n                tooltip: {\n                    y: {\n                        formatter: function(value) {\n                            return value + ' teachers';\n                        }\n                    }\n                }\n            };\n\n            this.charts.adoption = new ApexCharts(el, adoptionOptions);\n            this.charts.adoption.render();\n        },\n\n        /**\n         * Render the Bloom's Taxonomy radar chart.\n         * @param {object} data - Chart data object.\n         */\n        renderBloomsChart: function(data) {\n            var el = document.querySelector('#bloomsDistributionChart');\n            if (!el || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var bloomsOptions = {\n                series: [{\n                    name: 'Questions',\n                    data: data.bloomsValues\n                }],\n                chart: {\n                    type: 'radar',\n                    height: 350,\n                    fontFamily: 'inherit'\n                },\n                colors: ['#3B82F6'],\n                fill: {opacity: 0.15},\n                markers: {\n                    size: 4,\n                    colors: ['#3B82F6'],\n                    strokeWidth: 2,\n                    strokeColors: '#fff'\n                },\n                xaxis: {categories: data.bloomsLabels},\n                yaxis: {show: false},\n                grid: {show: false}\n            };\n\n            this.charts.blooms = new ApexCharts(el, bloomsOptions);\n            this.charts.blooms.render();\n        },\n\n        /**\n         * Render the Question Type bar chart.\n         * @param {object} data - Chart data object.\n         */\n        renderQuestionTypeChart: function(data) {\n            var el = document.querySelector('#questionTypeChart');\n            if (!el || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var questionTypeOptions = {\n                series: [{\n                    name: 'Questions',\n                    data: data.typeValues\n                }],\n                chart: {\n                    type: 'bar',\n                    height: 350,\n                    toolbar: {show: false},\n                    fontFamily: 'inherit'\n                },\n                plotOptions: {\n                    bar: {\n                        horizontal: false,\n                        borderRadius: 8,\n                        columnWidth: '60%'\n                    }\n                },\n                colors: ['#06B6D4'],\n                dataLabels: {enabled: false},\n                xaxis: {categories: data.typeLabels}\n            };\n\n            this.charts.questionType = new ApexCharts(el, questionTypeOptions);\n            this.charts.questionType.render();\n        },\n\n        /**\n         * Render the Difficulty Distribution horizontal bar chart.\n         * @param {object} data - Chart data object.\n         */\n        renderDifficultyChart: function(data) {\n            var el = document.querySelector('#difficultyChart');\n            if (!el || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var difficultyOptions = {\n                series: [{\n                    name: 'Questions',\n                    data: data.difficultyValues\n                }],\n                chart: {\n                    type: 'bar',\n                    height: 300,\n                    toolbar: {show: false},\n                    fontFamily: 'inherit'\n                },\n                plotOptions: {\n                    bar: {\n                        horizontal: true,\n                        borderRadius: 8\n                    }\n                },\n                colors: ['#F59E0B'],\n                dataLabels: {enabled: true},\n                xaxis: {categories: data.difficultyLabels}\n            };\n\n            this.charts.difficulty = new ApexCharts(el, difficultyOptions);\n            this.charts.difficulty.render();\n        }\n    };\n\n    return {\n        /**\n         * Module initialization entry point.\n         * @param {object} data - Chart data passed from PHP.\n         */\n        init: function(data) {\n            $(document).ready(function() {\n                AdminDashboard.init(data);\n            });\n        }\n    };\n});\n"],"names":["define","$","AdminDashboard","charts","init","data","self","this","waitForApexCharts","then","renderCharts","catch","Promise","resolve","ApexCharts","attempts","checkInterval","setInterval","clearInterval","renderUsageTrend","renderAdoptionChart","renderBloomsChart","renderQuestionTypeChart","renderDifficultyChart","el","document","querySelector","usageTrendOptions","series","name","trendCounts","chart","type","height","toolbar","show","fontFamily","colors","dataLabels","enabled","stroke","curve","width","fill","gradient","shadeIntensity","opacityFrom","opacityTo","xaxis","categories","trendDates","labels","tooltip","x","format","usageTrend","render","adoptionOptions","activeTeachers","inactiveTeachers","legend","position","fontSize","style","fontWeight","dropShadow","top","left","blur","color","opacity","plotOptions","pie","donut","total","label","value","states","hover","filter","active","y","formatter","adoption","bloomsOptions","bloomsValues","markers","size","strokeWidth","strokeColors","bloomsLabels","yaxis","grid","blooms","questionTypeOptions","typeValues","bar","horizontal","borderRadius","columnWidth","typeLabels","questionType","difficultyOptions","difficultyValues","difficultyLabels","difficulty","ready"],"mappings":"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"}