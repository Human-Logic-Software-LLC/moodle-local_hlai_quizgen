{"version":3,"file":"dashboard.min.js","sources":["../src/dashboard.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * AI Quiz Generator - Dashboard Module\n *\n * Handles dashboard initialization, AJAX data fetching,\n * and chart rendering for the teacher dashboard.\n *\n * @module     local_hlai_quizgen/dashboard\n * @package\n * @copyright  2025 Human Logic Software LLC\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* global ApexCharts */\ndefine(['jquery', 'core/ajax', 'local_hlai_quizgen/charts'], function($, Ajax, Charts) {\n    'use strict';\n\n    /**\n     * Dashboard controller\n     */\n    var Dashboard = {\n        courseid: 0,\n        refreshInterval: null,\n        charts: {},\n\n        /**\n         * Initialize the dashboard\n         * @param {object} config - Configuration object\n         */\n        init: function(config) {\n            this.courseid = config.courseid;\n            this.initData = config;\n\n            // Wait for ApexCharts to load\n            this.waitForApexCharts().then(function() {\n                Dashboard.initializeCharts();\n                Dashboard.loadChartData();\n                Dashboard.setupEventListeners();\n                return undefined;\n            }).catch(function() {\n                // ApexCharts loading failed silently.\n            });\n        },\n\n        /**\n         * Wait for ApexCharts library to be available\n         * @returns {Promise}\n         */\n        waitForApexCharts: function() {\n            return new Promise(function(resolve) {\n                if (typeof ApexCharts !== 'undefined') {\n                    resolve();\n                    return;\n                }\n\n                var attempts = 0;\n                var maxAttempts = 50;\n                var checkInterval = setInterval(function() {\n                    attempts++;\n                    if (typeof ApexCharts !== 'undefined') {\n                        clearInterval(checkInterval);\n                        resolve();\n                    } else if (attempts >= maxAttempts) {\n                        clearInterval(checkInterval);\n                        // ApexCharts did not load in time.\n                        resolve();\n                    }\n                }, 100);\n            });\n        },\n\n        /**\n         * Initialize all dashboard charts with loading states\n         */\n        initializeCharts: function() {\n            var stats = this.initData.stats || {};\n\n            // FTAR Gauge Chart\n            if ($('#ftar-gauge-chart').length && typeof ApexCharts !== 'undefined') {\n                this.charts.ftarGauge = Charts.createRadialChart('#ftar-gauge-chart', {\n                    series: [stats.ftar || 0],\n                    labels: ['First-Time Acceptance'],\n                    colors: [this.getFtarColor(stats.ftar || 0)],\n                    height: 280,\n                    plotOptions: {\n                        radialBar: {\n                            startAngle: -135,\n                            endAngle: 135,\n                            hollow: {\n                                margin: 0,\n                                size: '70%',\n                                background: 'transparent'\n                            },\n                            track: {\n                                background: '#f0f0f0',\n                                strokeWidth: '100%'\n                            },\n                            dataLabels: {\n                                name: {\n                                    offsetY: -10,\n                                    color: '#666',\n                                    fontSize: '14px'\n                                },\n                                value: {\n                                    color: '#333',\n                                    fontSize: '36px',\n                                    fontWeight: 'bold',\n                                    formatter: function(val) {\n                                        return val.toFixed(1) + '%';\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n            }\n\n            // Initialize type distribution from PHP data\n            var typeData = this.initData.typeDistribution || [];\n            if ($('#question-type-chart').length && typeData.length > 0 && typeof ApexCharts !== 'undefined') {\n                var labels = typeData.map(function(item) {\n                    return Dashboard.formatQuestionType(item.questiontype);\n                });\n                var series = typeData.map(function(item) {\n                    return parseInt(item.count, 10);\n                });\n                var colors = typeData.map(function(item) {\n                    return Charts.getQuestionTypeColor(item.questiontype);\n                });\n\n                this.charts.questionType = Charts.createDonutChart('#question-type-chart', {\n                    series: series,\n                    labels: labels,\n                    colors: colors,\n                    height: 280\n                });\n            }\n        },\n\n        /**\n         * Load chart data via AJAX\n         */\n        loadChartData: function() {\n            var self = this;\n\n            // Load acceptance trend\n            this.fetchData('acceptancetrend').then(function(data) {\n                self.renderAcceptanceTrendChart(data);\n                return undefined;\n            }).catch(function() {\n                // Data fetch handled by fetchData.\n            });\n\n            // Load difficulty distribution\n            this.fetchData('difficultydist').then(function(data) {\n                self.renderDifficultyChart(data);\n                return undefined;\n            }).catch(function() {\n                // Data fetch handled by fetchData.\n            });\n\n            // Load Bloom's distribution\n            this.fetchData('bloomsdist').then(function(data) {\n                self.renderBloomsCharts(data);\n                return undefined;\n            }).catch(function() {\n                // Data fetch handled by fetchData.\n            });\n\n            // Load regeneration by type\n            this.fetchData('regenbytype').then(function(data) {\n                self.renderRegenByTypeChart(data);\n                return undefined;\n            }).catch(function() {\n                // Data fetch handled by fetchData.\n            });\n        },\n\n        /**\n         * Fetch data from Moodle External Services.\n         * @param {string} action - The action identifier to perform.\n         * @returns {Promise}\n         */\n        fetchData: function(action) {\n            var cid = this.courseid || 0;\n            var methodMap = {\n                'acceptancetrend': {methodname: 'local_hlai_quizgen_get_acceptance_trend', args: {courseid: cid}},\n                'difficultydist': {methodname: 'local_hlai_quizgen_get_difficulty_distribution', args: {courseid: cid}},\n                'bloomsdist': {methodname: 'local_hlai_quizgen_get_blooms_distribution', args: {courseid: cid}},\n                'regenbytype': {methodname: 'local_hlai_quizgen_get_regeneration_by_type', args: {courseid: cid}}\n            };\n\n            var call = methodMap[action];\n            if (!call) {\n                return Promise.reject('Unknown action: ' + action);\n            }\n\n            return Ajax.call([call])[0].then(function(response) {\n                // The regeneration-by-type endpoint returns a JSON string in the 'data' key.\n                if (action === 'regenbytype') {\n                    return JSON.parse(response.data);\n                }\n                return response;\n            }).catch(function(error) {\n                // eslint-disable-next-line no-console\n                console.error('External service call failed for ' + action + ':', error);\n                return null;\n            });\n        },\n\n        /**\n         * Render acceptance trend line chart\n         * @param {object} data - Chart data\n         */\n        renderAcceptanceTrendChart: function(data) {\n            if (!data || !$('#acceptance-trend-chart').length || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            // Clear loading skeleton\n            $('#acceptance-trend-chart').empty();\n\n            var categories = data.labels || [];\n            var acceptanceRates = data.acceptance_rates || [];\n            var ftarRates = data.ftar_rates || [];\n\n            if (categories.length === 0) {\n                $('#acceptance-trend-chart').html(\n                    '<div class=\"has-text-centered has-text-grey p-5\">' +\n                    '<p>Not enough data to show trends yet.</p>' +\n                    '<p class=\"mt-2\" style=\"font-size: 0.85rem;\">Generate more quizzes to see patterns.</p>' +\n                    '</div>'\n                );\n                return;\n            }\n\n            this.charts.acceptanceTrend = Charts.createLineChart('#acceptance-trend-chart', {\n                series: [\n                    {\n                        name: 'Acceptance Rate',\n                        data: acceptanceRates\n                    },\n                    {\n                        name: 'First-Time Acceptance',\n                        data: ftarRates\n                    }\n                ],\n                categories: categories,\n                colors: ['#4F46E5', '#10B981'],\n                height: 300,\n                stroke: {\n                    curve: 'smooth',\n                    width: 3\n                },\n                markers: {\n                    size: 5\n                },\n                yaxis: {\n                    min: 0,\n                    max: 100,\n                    labels: {\n                        formatter: function(val) {\n                            return val.toFixed(0) + '%';\n                        }\n                    }\n                }\n            });\n        },\n\n        /**\n         * Render difficulty distribution chart\n         * @param {object} data - Chart data\n         */\n        renderDifficultyChart: function(data) {\n            if (!data || !$('#difficulty-chart').length || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var difficulties = ['easy', 'medium', 'hard'];\n            var series = [];\n            var labels = [];\n            var colors = [];\n\n            difficulties.forEach(function(diff) {\n                var count = data[diff] || 0;\n                if (count > 0) {\n                    series.push(count);\n                    labels.push(diff.charAt(0).toUpperCase() + diff.slice(1));\n                    colors.push(Charts.getDifficultyColor(diff));\n                }\n            });\n\n            if (series.length === 0) {\n                $('#difficulty-chart').html(\n                    '<div class=\"has-text-centered has-text-grey p-5\">' +\n                    '<p>No difficulty data available</p>' +\n                    '</div>'\n                );\n                return;\n            }\n\n            this.charts.difficulty = Charts.createDonutChart('#difficulty-chart', {\n                series: series,\n                labels: labels,\n                colors: colors,\n                height: 280\n            });\n        },\n\n        /**\n         * Render Bloom's taxonomy charts\n         * @param {object} data - Chart data\n         */\n        renderBloomsCharts: function(data) {\n            if (!data || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var bloomsLevels = ['remember', 'understand', 'apply', 'analyze', 'evaluate', 'create'];\n            var bloomsLabels = ['Remember', 'Understand', 'Apply', 'Analyze', 'Evaluate', 'Create'];\n            var series = [];\n            var barColors = [];\n\n            bloomsLevels.forEach(function(level) {\n                series.push(data[level] || 0);\n                barColors.push(Charts.getBloomsColor(level));\n            });\n\n            // Enhanced Radar chart - ABSOLUTELY NO NUMBERS\n            if ($('#blooms-radar-chart').length) {\n                var radarOptions = {\n                    chart: {\n                        type: 'radar',\n                        height: 400,\n                        fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, sans-serif',\n                        toolbar: {show: false},\n                        dropShadow: {\n                            enabled: true,\n                            blur: 4,\n                            left: 0,\n                            top: 0,\n                            opacity: 0.1\n                        }\n                    },\n                    series: [{\n                        name: 'Questions',\n                        data: series\n                    }],\n                    dataLabels: {\n                        enabled: false\n                    },\n                    xaxis: {\n                        categories: bloomsLabels,\n                        labels: {\n                            show: true,\n                            style: {\n                                colors: barColors,\n                                fontSize: '13px',\n                                fontWeight: 600\n                            }\n                        }\n                    },\n                    yaxis: {\n                        show: false,\n                        labels: {\n                            show: false\n                        },\n                        tickAmount: 0\n                    },\n                    grid: {\n                        show: false\n                    },\n                    fill: {\n                        opacity: 0.2,\n                        type: 'solid'\n                    },\n                    stroke: {\n                        width: 2,\n                        colors: ['#4F46E5']\n                    },\n                    markers: {\n                        size: 5,\n                        colors: ['#4F46E5'],\n                        strokeColors: '#fff',\n                        strokeWidth: 2,\n                        hover: {\n                            size: 7\n                        }\n                    },\n                    colors: ['#4F46E5'],\n                    legend: {\n                        show: false\n                    },\n                    tooltip: {\n                        enabled: true,\n                        y: {\n                            formatter: function(val) {\n                                return val + ' questions';\n                            }\n                        }\n                    },\n                    plotOptions: {\n                        radar: {\n                            size: 140,\n                            polygons: {\n                                strokeColors: '#E5E7EB',\n                                strokeWidth: 1,\n                                connectorColors: '#E5E7EB',\n                                fill: {\n                                    colors: ['#F9FAFB', '#F3F4F6']\n                                }\n                            }\n                        }\n                    }\n                };\n                this.charts.bloomsRadar = new ApexCharts(document.querySelector('#blooms-radar-chart'), radarOptions);\n                this.charts.bloomsRadar.render();\n            }\n\n            // Bar chart - NO LEGEND\n            if ($('#blooms-bar-chart').length) {\n                var barOptions = {\n                    chart: {\n                        type: 'bar',\n                        height: 400,\n                        fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, sans-serif',\n                        toolbar: {show: false}\n                    },\n                    series: [{\n                        name: 'Questions',\n                        data: series\n                    }],\n                    plotOptions: {\n                        bar: {\n                            horizontal: true,\n                            borderRadius: 6,\n                            distributed: true,\n                            barHeight: '65%'\n                        }\n                    },\n                    dataLabels: {\n                        enabled: true,\n                        style: {\n                            fontSize: '13px',\n                            fontWeight: 'bold',\n                            colors: ['#fff']\n                        }\n                    },\n                    xaxis: {\n                        categories: bloomsLabels,\n                        labels: {\n                            style: {\n                                fontSize: '12px',\n                                colors: '#6B7280'\n                            }\n                        }\n                    },\n                    yaxis: {\n                        labels: {\n                            style: {\n                                fontSize: '13px',\n                                fontWeight: 500,\n                                colors: barColors\n                            }\n                        }\n                    },\n                    colors: barColors,\n                    legend: {\n                        show: false\n                    },\n                    tooltip: {\n                        y: {\n                            formatter: function(val) {\n                                return val + ' questions';\n                            }\n                        }\n                    }\n                };\n                this.charts.bloomsBar = new ApexCharts(document.querySelector('#blooms-bar-chart'), barOptions);\n                this.charts.bloomsBar.render();\n            }\n        },\n\n        /**\n         * Render regeneration by type chart\n         * @param {object} data - Chart data\n         */\n        renderRegenByTypeChart: function(data) {\n            if (!data || !$('#regen-by-type-chart').length || typeof ApexCharts === 'undefined') {\n                return;\n            }\n\n            var types = Object.keys(data);\n            var series = [];\n            var labels = [];\n            var colors = [];\n\n            types.forEach(function(type) {\n                var avgRegen = data[type].avg_regenerations || 0;\n                series.push(parseFloat(avgRegen.toFixed(2)));\n                labels.push(Dashboard.formatQuestionType(type));\n                colors.push(Charts.getQuestionTypeColor(type));\n            });\n\n            if (series.length === 0) {\n                $('#regen-by-type-chart').html(\n                    '<div class=\"has-text-centered has-text-grey p-4\">' +\n                    '<p>No regeneration data yet</p>' +\n                    '</div>'\n                );\n                return;\n            }\n\n            this.charts.regenByType = Charts.createBarChart('#regen-by-type-chart', {\n                series: [{\n                    name: 'Avg Regenerations',\n                    data: series\n                }],\n                categories: labels,\n                colors: colors,\n                horizontal: true,\n                height: 250,\n                distributed: true,\n                dataLabels: {\n                    enabled: true,\n                    formatter: function(val) {\n                        return val.toFixed(1);\n                    }\n                }\n            });\n        },\n\n        /**\n         * Setup event listeners\n         */\n        setupEventListeners: function() {\n            var self = this;\n\n            // Refresh data button (if exists)\n            $(document).on('click', '.js-refresh-dashboard', function(e) {\n                e.preventDefault();\n                self.refreshDashboard();\n            });\n\n            // Delete notification button\n            $(document).on('click', '.hlai-dismiss-notification, .hlai-notification .delete', function() {\n                $(this).closest('.notification, .hlai-notification').fadeOut(300, function() {\n                    $(this).remove();\n                });\n            });\n        },\n\n        /**\n         * Refresh all dashboard data\n         */\n        refreshDashboard: function() {\n            // Destroy existing charts\n            Object.keys(this.charts).forEach(function(key) {\n                if (Dashboard.charts[key] && typeof Dashboard.charts[key].destroy === 'function') {\n                    Dashboard.charts[key].destroy();\n                }\n            });\n            this.charts = {};\n\n            // Reload data\n            this.loadChartData();\n        },\n\n        /**\n         * Get color based on FTAR percentage\n         * @param {number} ftar - First-time acceptance rate\n         * @returns {string} Color hex code\n         */\n        getFtarColor: function(ftar) {\n            if (ftar >= 75) {\n                return '#10B981'; // Success green\n            } else if (ftar >= 60) {\n                return '#F59E0B'; // Warning yellow\n            } else if (ftar >= 45) {\n                return '#F97316'; // Orange\n            } else {\n                return '#EF4444'; // Danger red\n            }\n        },\n\n        /**\n         * Format question type for display\n         * @param {string} type - Raw question type\n         * @returns {string} Formatted type name\n         */\n        formatQuestionType: function(type) {\n            var typeMap = {\n                'multichoice': 'Multiple Choice',\n                'truefalse': 'True/False',\n                'shortanswer': 'Short Answer',\n                'essay': 'Essay',\n                'numerical': 'Numerical',\n                'matching': 'Matching',\n                'ordering': 'Ordering',\n                'cloze': 'Cloze',\n                'description': 'Description'\n            };\n            return typeMap[type] || type.charAt(0).toUpperCase() + type.slice(1);\n        }\n    };\n\n    return {\n        /**\n         * Module initialization entry point\n         * @param {Object} config - Configuration object with courseid, sesskey, stats, typeDistribution\n         */\n        init: function(config) {\n            $(document).ready(function() {\n                Dashboard.init(config);\n            });\n        }\n    };\n});\n"],"names":["define","$","Ajax","Charts","Dashboard","courseid","refreshInterval","charts","init","config","initData","waitForApexCharts","then","initializeCharts","loadChartData","setupEventListeners","catch","Promise","resolve","ApexCharts","attempts","checkInterval","setInterval","clearInterval","stats","this","length","ftarGauge","createRadialChart","series","ftar","labels","colors","getFtarColor","height","plotOptions","radialBar","startAngle","endAngle","hollow","margin","size","background","track","strokeWidth","dataLabels","name","offsetY","color","fontSize","value","fontWeight","formatter","val","toFixed","typeData","typeDistribution","map","item","formatQuestionType","questiontype","parseInt","count","getQuestionTypeColor","questionType","createDonutChart","self","fetchData","data","renderAcceptanceTrendChart","renderDifficultyChart","renderBloomsCharts","renderRegenByTypeChart","action","cid","call","methodname","args","response","JSON","parse","error","console","reject","empty","categories","acceptanceRates","acceptance_rates","ftarRates","ftar_rates","acceptanceTrend","createLineChart","stroke","curve","width","markers","yaxis","min","max","html","forEach","diff","push","charAt","toUpperCase","slice","getDifficultyColor","difficulty","bloomsLabels","barColors","level","getBloomsColor","radarOptions","chart","type","fontFamily","toolbar","show","dropShadow","enabled","blur","left","top","opacity","xaxis","style","tickAmount","grid","fill","strokeColors","hover","legend","tooltip","y","radar","polygons","connectorColors","bloomsRadar","document","querySelector","render","barOptions","bar","horizontal","borderRadius","distributed","barHeight","bloomsBar","types","Object","keys","avgRegen","avg_regenerations","parseFloat","regenByType","createBarChart","on","e","preventDefault","refreshDashboard","closest","fadeOut","remove","key","destroy","ready"],"mappings":"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"}