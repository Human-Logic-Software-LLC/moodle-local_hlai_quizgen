/**
 * AI Quiz Generator - Analytics Module
 *
 * Handles chart rendering and data visualization
 * for the comprehensive analytics page.
 *
 * @module     local_hlai_quizgen/analytics
 * @copyright  2025 Human Logic Software LLC
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
/**
 * AI Quiz Generator - Analytics Module
 *
 * Handles chart rendering and data visualization
 * for the comprehensive analytics page.
 *
 * @module     local_hlai_quizgen/analytics
 * @copyright  2025 Human Logic Software LLC
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_hlai_quizgen/analytics",["jquery","local_hlai_quizgen/charts"],function($,Charts){var Analytics={courseid:0,sesskey:"",timerange:"30",charts:{},init:function(config){this.courseid=config.courseid,this.sesskey=config.sesskey,this.timerange=config.timerange,this.initData=config,this.waitForApexCharts().then(function(){Analytics.renderAllCharts()}).catch(function(){})},waitForApexCharts:function(){return new Promise(function(resolve){if("undefined"==typeof ApexCharts)var attempts=0,checkInterval=setInterval(function(){attempts++,("undefined"!=typeof ApexCharts||attempts>=50)&&(clearInterval(checkInterval),resolve())},100);else resolve()})},renderAllCharts:function(){var data=this.initData||{},stats=data.stats||{};this.renderFunnelChart(stats),this.renderQualityDistChart(),this.renderTypeAcceptanceChart(data.typeStats),this.renderDifficultyAnalysisChart(data.difficultyStats),this.renderBloomsCoverageChart(data.bloomsStats),this.renderRegenDistChart(),this.renderRegenByDifficultyChart(),this.renderRejectionReasonsChart(data.rejectionReasons),this.renderTrendsChart()},renderFunnelChart:function(stats){if($("#funnel-chart").length&&"undefined"!=typeof ApexCharts){var total=stats.totalQuestions||0,approved=stats.approved||0,options={series:[{name:"Questions",data:[total,total-(stats.pending||0),approved,Math.round(.8*approved)]}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%",distributed:!0,dataLabels:{position:"bottom"}}},colors:["#4F46E5","#F59E0B","#10B981","#06B6D4"],dataLabels:{enabled:!0,textAnchor:"start",formatter:function(val,opt){return["Generated","Reviewed","Approved","Deployed"][opt.dataPointIndex]+": "+val},offsetX:10,style:{fontSize:"14px",colors:["#fff"]}},xaxis:{categories:["Generated","Reviewed","Approved","Deployed"]},yaxis:{labels:{show:!1}},legend:{show:!1}};this.charts.funnel=new ApexCharts(document.querySelector("#funnel-chart"),options),this.charts.funnel.render()}},renderQualityDistChart:function(){if($("#quality-dist-chart").length&&"undefined"!=typeof ApexCharts){var options={series:[{name:"Questions",data:[5,10,25,35,25]}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:8,columnWidth:"60%",distributed:!0}},colors:["#EF4444","#F97316","#F59E0B","#10B981","#059669"],dataLabels:{enabled:!0,formatter:function(val){return val+"%"}},xaxis:{categories:["0-20","21-40","41-60","61-80","81-100"],title:{text:"Quality Score Range"}},yaxis:{title:{text:"Percentage of Questions"}},legend:{show:!1}};this.charts.qualityDist=new ApexCharts(document.querySelector("#quality-dist-chart"),options),this.charts.qualityDist.render()}},renderTypeAcceptanceChart:function(typeStats){if($("#type-acceptance-chart").length&&"undefined"!=typeof ApexCharts&&typeStats){var categories=[],totalData=[],approvedData=[];typeStats.forEach(function(item){item.questiontype&&(categories.push(Analytics.formatQuestionType(item.questiontype)),totalData.push(parseInt(item.count)||0),approvedData.push(parseInt(item.approved)||0))});var options={series:[{name:"Total",data:totalData},{name:"Approved",data:approvedData}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},colors:["#94A3B8","#10B981"],dataLabels:{enabled:!1},xaxis:{categories:categories},yaxis:{title:{text:"Number of Questions"}},legend:{position:"top",horizontalAlign:"right"},fill:{opacity:1}};this.charts.typeAcceptance=new ApexCharts(document.querySelector("#type-acceptance-chart"),options),this.charts.typeAcceptance.render()}},renderDifficultyAnalysisChart:function(difficultyStats){if($("#difficulty-analysis-chart").length&&"undefined"!=typeof ApexCharts&&difficultyStats){var series=[],labels=[];difficultyStats.forEach(function(item){item.difficulty&&(labels.push(item.difficulty.charAt(0).toUpperCase()+item.difficulty.slice(1)),series.push(parseInt(item.count)||0))}),this.charts.difficultyAnalysis=Charts.createDonutChart("#difficulty-analysis-chart",{series:series,labels:labels,colors:["#10B981","#F59E0B","#EF4444"],height:350})}},renderBloomsCoverageChart:function(bloomsStats){if($("#blooms-coverage-chart").length&&"undefined"!=typeof ApexCharts&&bloomsStats){var series=[];["remember","understand","apply","analyze","evaluate","create"].forEach(function(level){var found=bloomsStats.find(function(item){return item.blooms_level&&item.blooms_level.toLowerCase()===level});series.push(found&&parseInt(found.count)||0)});var options={series:[{name:"Questions",data:series}],chart:{type:"radar",height:350,toolbar:{show:!1},animations:{enabled:!0,speed:800}},xaxis:{categories:["Remember","Understand","Apply","Analyze","Evaluate","Create"],labels:{show:!0,style:{colors:["#4F46E5","#7C3AED","#EC4899","#F59E0B","#10B981","#3B82F6"],fontSize:"13px",fontWeight:600}}},yaxis:{show:!1,labels:{show:!1},tickAmount:0},grid:{show:!1},fill:{opacity:.2,type:"solid"},stroke:{width:2,colors:["#4F46E5"]},markers:{size:5,colors:["#4F46E5"],strokeColors:"#fff",strokeWidth:2,hover:{size:7}},colors:["#4F46E5"],legend:{show:!1},dataLabels:{enabled:!1}};this.charts.bloomsCoverage=new ApexCharts(document.querySelector("#blooms-coverage-chart"),options),this.charts.bloomsCoverage.render()}},renderRegenDistChart:function(){if($("#regen-dist-chart").length&&"undefined"!=typeof ApexCharts){this.charts.regenDist=new ApexCharts(document.querySelector("#regen-dist-chart"),{series:[{name:"Questions",data:[65,20,10,3,2]}],chart:{type:"bar",height:280,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,columnWidth:"50%",distributed:!0}},colors:["#10B981","#22C55E","#F59E0B","#F97316","#EF4444"],dataLabels:{enabled:!0,formatter:function(val){return val+"%"}},xaxis:{categories:["0","1","2","3","4+"],title:{text:"Number of Regenerations"}},yaxis:{title:{text:"Percentage"}},legend:{show:!1}}),this.charts.regenDist.render()}},renderRegenByDifficultyChart:function(){if($("#regen-by-difficulty-chart").length&&"undefined"!=typeof ApexCharts){this.charts.regenByDiff=new ApexCharts(document.querySelector("#regen-by-difficulty-chart"),{series:[{name:"Avg Regenerations",data:[.8,1.2,1.8]}],chart:{type:"bar",height:280,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0,borderRadius:4,barHeight:"50%",distributed:!0}},colors:["#10B981","#F59E0B","#EF4444"],dataLabels:{enabled:!0},xaxis:{categories:["Easy","Medium","Hard"],title:{text:"Avg Regenerations"}},legend:{show:!1}}),this.charts.regenByDiff.render()}},renderRejectionReasonsChart:function(rejectionReasons){if($("#rejection-reasons-chart").length&&"undefined"!=typeof ApexCharts&&rejectionReasons&&0!==rejectionReasons.length){var series=[],labels=[];rejectionReasons.forEach(function(item){labels.push(item.reason||"Not specified"),series.push(parseInt(item.count)||0)}),this.charts.rejectionReasons=Charts.createDonutChart("#rejection-reasons-chart",{series:series,labels:labels,colors:["#EF4444","#F97316","#F59E0B","#6366F1","#8B5CF6"],height:300})}},renderTrendsChart:function(){if($("#trends-chart").length&&"undefined"!=typeof ApexCharts){for(var categories=[],now=new Date,i=29;i>=0;i--){var date=new Date(now);date.setDate(date.getDate()-i),categories.push(date.toLocaleDateString("en-US",{month:"short",day:"numeric"}))}for(var generated=[],approved=[],j=0;j<30;j++){var gen=Math.floor(15*Math.random())+5;generated.push(gen),approved.push(Math.floor(gen*(.6+.3*Math.random())))}var options={series:[{name:"Generated",data:generated},{name:"Approved",data:approved}],chart:{type:"area",height:350,toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#4F46E5","#10B981"],fill:{type:"gradient",gradient:{opacityFrom:.4,opacityTo:.1}},xaxis:{categories:categories,labels:{rotate:-45,rotateAlways:!0}},yaxis:{title:{text:"Questions"}},legend:{position:"top",horizontalAlign:"right"},tooltip:{x:{format:"MMM dd"}}};this.charts.trends=new ApexCharts(document.querySelector("#trends-chart"),options),this.charts.trends.render()}},formatQuestionType:function(type){return{multichoice:"MCQ",truefalse:"T/F",shortanswer:"Short",essay:"Essay",numerical:"Num",matching:"Match",ordering:"Order",cloze:"Cloze"}[type]||type}};return{init:function(config){$(document).ready(function(){Analytics.init(config)})}}});

//# sourceMappingURL=analytics.min.js.map