/**
 * AI Quiz Generator - Analytics Module
 *
 * Handles chart rendering and data visualization
 * for the comprehensive analytics page.
 *
 * @module     local_hlai_quizgen/analytics
 * @copyright  2025 Human Logic Software LLC
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["jquery","local_hlai_quizgen/charts"],function(e,t){"use strict";var r={courseid:0,sesskey:"",timerange:"30",charts:{},init:function(e){this.courseid=e.courseid,this.sesskey=e.sesskey,this.timerange=e.timerange,this.initData=e,this.waitForApexCharts().then(function(){r.renderAllCharts()}).catch(function(){})},waitForApexCharts:function(){return new Promise(function(e){if("undefined"==typeof ApexCharts)var t=0,r=setInterval(function(){t++,("undefined"!=typeof ApexCharts||t>=50)&&(clearInterval(r),e())},100);else e()})},renderAllCharts:function(){var e=this.initData||{},t=e.stats||{};this.renderFunnelChart(t),this.renderQualityDistChart(),this.renderTypeAcceptanceChart(e.typeStats),this.renderDifficultyAnalysisChart(e.difficultyStats),this.renderBloomsCoverageChart(e.bloomsStats),this.renderRegenDistChart(),this.renderRegenByDifficultyChart(),this.renderRejectionReasonsChart(e.rejectionReasons),this.renderTrendsChart()},renderFunnelChart:function(t){if(e("#funnel-chart").length&&"undefined"!=typeof ApexCharts){var r=t.totalQuestions||0,a=t.approved||0,n={series:[{name:"Questions",data:[r,r-(t.pending||0),a,Math.round(.8*a)]}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0,borderRadius:8,barHeight:"60%",distributed:!0,dataLabels:{position:"bottom"}}},colors:["#4F46E5","#F59E0B","#10B981","#06B6D4"],dataLabels:{enabled:!0,textAnchor:"start",formatter:function(e,t){return["Generated","Reviewed","Approved","Deployed"][t.dataPointIndex]+": "+e},offsetX:10,style:{fontSize:"14px",colors:["#fff"]}},xaxis:{categories:["Generated","Reviewed","Approved","Deployed"]},yaxis:{labels:{show:!1}},legend:{show:!1}};this.charts.funnel=new ApexCharts(document.querySelector("#funnel-chart"),n),this.charts.funnel.render()}},renderQualityDistChart:function(){if(e("#quality-dist-chart").length&&"undefined"!=typeof ApexCharts){var t={series:[{name:"Questions",data:[5,10,25,35,25]}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:8,columnWidth:"60%",distributed:!0}},colors:["#EF4444","#F97316","#F59E0B","#10B981","#059669"],dataLabels:{enabled:!0,formatter:function(e){return e+"%"}},xaxis:{categories:["0-20","21-40","41-60","61-80","81-100"],title:{text:"Quality Score Range"}},yaxis:{title:{text:"Percentage of Questions"}},legend:{show:!1}};this.charts.qualityDist=new ApexCharts(document.querySelector("#quality-dist-chart"),t),this.charts.qualityDist.render()}},renderTypeAcceptanceChart:function(t){if(e("#type-acceptance-chart").length&&"undefined"!=typeof ApexCharts&&t){var a=[],n=[],s=[];t.forEach(function(e){e.questiontype&&(a.push(r.formatQuestionType(e.questiontype)),n.push(parseInt(e.count)||0),s.push(parseInt(e.approved)||0))});var i={series:[{name:"Total",data:n},{name:"Approved",data:s}],chart:{type:"bar",height:350,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:4}},colors:["#94A3B8","#10B981"],dataLabels:{enabled:!1},xaxis:{categories:a},yaxis:{title:{text:"Number of Questions"}},legend:{position:"top",horizontalAlign:"right"},fill:{opacity:1}};this.charts.typeAcceptance=new ApexCharts(document.querySelector("#type-acceptance-chart"),i),this.charts.typeAcceptance.render()}},renderDifficultyAnalysisChart:function(r){if(e("#difficulty-analysis-chart").length&&"undefined"!=typeof ApexCharts&&r){var a=[],n=[];r.forEach(function(e){e.difficulty&&(n.push(e.difficulty.charAt(0).toUpperCase()+e.difficulty.slice(1)),a.push(parseInt(e.count)||0))}),this.charts.difficultyAnalysis=t.createDonutChart("#difficulty-analysis-chart",{series:a,labels:n,colors:["#10B981","#F59E0B","#EF4444"],height:350})}},renderBloomsCoverageChart:function(t){if(e("#blooms-coverage-chart").length&&"undefined"!=typeof ApexCharts&&t){var r=[];["remember","understand","apply","analyze","evaluate","create"].forEach(function(e){var a=t.find(function(t){return t.blooms_level&&t.blooms_level.toLowerCase()===e});r.push(a&&parseInt(a.count)||0)});var a={series:[{name:"Questions",data:r}],chart:{type:"radar",height:350,toolbar:{show:!1},animations:{enabled:!0,speed:800}},xaxis:{categories:["Remember","Understand","Apply","Analyze","Evaluate","Create"],labels:{show:!0,style:{colors:["#4F46E5","#7C3AED","#EC4899","#F59E0B","#10B981","#3B82F6"],fontSize:"13px",fontWeight:600}}},yaxis:{show:!1,labels:{show:!1},tickAmount:0},grid:{show:!1},fill:{opacity:.2,type:"solid"},stroke:{width:2,colors:["#4F46E5"]},markers:{size:5,colors:["#4F46E5"],strokeColors:"#fff",strokeWidth:2,hover:{size:7}},colors:["#4F46E5"],legend:{show:!1},dataLabels:{enabled:!1}};this.charts.bloomsCoverage=new ApexCharts(document.querySelector("#blooms-coverage-chart"),a),this.charts.bloomsCoverage.render()}},renderRegenDistChart:function(){if(e("#regen-dist-chart").length&&"undefined"!=typeof ApexCharts){this.charts.regenDist=new ApexCharts(document.querySelector("#regen-dist-chart"),{series:[{name:"Questions",data:[65,20,10,3,2]}],chart:{type:"bar",height:280,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,columnWidth:"50%",distributed:!0}},colors:["#10B981","#22C55E","#F59E0B","#F97316","#EF4444"],dataLabels:{enabled:!0,formatter:function(e){return e+"%"}},xaxis:{categories:["0","1","2","3","4+"],title:{text:"Number of Regenerations"}},yaxis:{title:{text:"Percentage"}},legend:{show:!1}}),this.charts.regenDist.render()}},renderRegenByDifficultyChart:function(){if(e("#regen-by-difficulty-chart").length&&"undefined"!=typeof ApexCharts){this.charts.regenByDiff=new ApexCharts(document.querySelector("#regen-by-difficulty-chart"),{series:[{name:"Avg Regenerations",data:[.8,1.2,1.8]}],chart:{type:"bar",height:280,toolbar:{show:!1}},plotOptions:{bar:{horizontal:!0,borderRadius:4,barHeight:"50%",distributed:!0}},colors:["#10B981","#F59E0B","#EF4444"],dataLabels:{enabled:!0},xaxis:{categories:["Easy","Medium","Hard"],title:{text:"Avg Regenerations"}},legend:{show:!1}}),this.charts.regenByDiff.render()}},renderRejectionReasonsChart:function(r){if(e("#rejection-reasons-chart").length&&"undefined"!=typeof ApexCharts&&r&&0!==r.length){var a=[],n=[];r.forEach(function(e){n.push(e.reason||"Not specified"),a.push(parseInt(e.count)||0)}),this.charts.rejectionReasons=t.createDonutChart("#rejection-reasons-chart",{series:a,labels:n,colors:["#EF4444","#F97316","#F59E0B","#6366F1","#8B5CF6"],height:300})}},renderTrendsChart:function(){if(e("#trends-chart").length&&"undefined"!=typeof ApexCharts){for(var t=[],r=new Date,a=29;a>=0;a--){var n=new Date(r);n.setDate(n.getDate()-a),t.push(n.toLocaleDateString("en-US",{month:"short",day:"numeric"}))}for(var s=[],i=[],o=0;o<30;o++){var h=Math.floor(15*Math.random())+5;s.push(h),i.push(Math.floor(h*(.6+.3*Math.random())))}var c={series:[{name:"Generated",data:s},{name:"Approved",data:i}],chart:{type:"area",height:350,toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},colors:["#4F46E5","#10B981"],fill:{type:"gradient",gradient:{opacityFrom:.4,opacityTo:.1}},xaxis:{categories:t,labels:{rotate:-45,rotateAlways:!0}},yaxis:{title:{text:"Questions"}},legend:{position:"top",horizontalAlign:"right"},tooltip:{x:{format:"MMM dd"}}};this.charts.trends=new ApexCharts(document.querySelector("#trends-chart"),c),this.charts.trends.render()}},formatQuestionType:function(e){return{multichoice:"MCQ",truefalse:"T/F",shortanswer:"Short",essay:"Essay",numerical:"Num",matching:"Match",ordering:"Order",cloze:"Cloze"}[e]||e}};return{init:function(t){e(document).ready(function(){r.init(t)})}}});
//# sourceMappingURL=analytics.min.js.map